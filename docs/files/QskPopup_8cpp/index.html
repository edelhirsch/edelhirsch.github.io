<!doctype html>
<html lang="en">
    <head>    

        <title>controls/QskPopup.cpp - Stackbit Libris Theme</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="A documentation theme"/>
        <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%26display=swap" rel="stylesheet"> 
        <link rel="stylesheet" href="/assets/css/main.css">
        
    </head>
    <body>
        
        <div id="page" class="site">
  <header id="masthead" class="site-header outer">
  <div class="inner">
    <div class="site-header-inside">
      <div class="site-branding">
        
        
        <p class="site-title"><a href="/"></a></p>
        
      </div><!-- .site-branding -->
      
      
      <nav id="main-navigation" class="site-navigation" aria-label="Main Navigation">
        <div class="site-nav-inside">
          <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-close" aria-hidden="true"></span></button>
          <ul class="menu">
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/">
  
  Home
  
</a>

              
            </li>
          
            
            
            <li class="menu-item">
              
              
<a class="" href="/docs">
  
  Documentation
  
</a>

              
            </li>
          
            
            
            <li class="menu-item menu-button">
              
              
<a class="button" href="https://github.com/uwerat/qskinny">
  
  GitHub
  
</a>

              
            </li>
          
          </ul>
        </div><!-- .site-nav-inside -->
      </nav><!-- .site-navigation -->
      <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
      
    </div><!-- .site-header-inside -->
  </div><!-- .inner -->
</header><!-- .site-header -->

  <main id="content" class="site-content">
    <div class="inner outer">
  <div class="docs-content">
    
    




<nav id="docs-nav" class="docs-nav">
  <div id="docs-nav-inside" class="docs-nav-inside sticky">
    <button id="docs-nav-toggle" class="docs-nav-toggle">Navigate Docs<span class="icon-angle-right" aria-hidden="true"></span></button>
    <div class="docs-nav-menu">
      <ul id="docs-menu" class="docs-menu">
        <li class="docs-menu-item">
          <a href="/docs/">Introduction</a>
        </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/tutorials/">Tutorials</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/1-QSkinny/">1. Introduction</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/2-writing-your-first-application/">2. Writing your first application</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/3-Layouts/">3. Layouts</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/4-Skins/">4. Skins</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/5-scalable-graphics/">5. (Scalable) graphics</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/6-parents-and-parent-items/">6. Parents and parent items</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/7-qskinny-and-qml/">7. Using QSkinny and QML</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/8-writing-own-controls/">8. Writing own controls</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/tutorials/9-scene-graph/">9. Scene graph representations of controls</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/modules/">Modules</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Animation/">Animation</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Controls/">Controls</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Core/">Core</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Dialogs/">Dialogs</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Framework/">Framework</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Graphic/">Graphic</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Layouts/">Layouts</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Scenegraph/">Scenegraph</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Skinlets/">Skinlets</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__Themeing/">Themeing</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___animation/">Animation</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___container/">Container</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___controls/">Controls</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___core/">Core</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___dialogs/">Dialogs</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___framework/">Framework</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___graphic/">Graphic</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___layouts/">Layouts</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___scenegraph/">Scenegraph</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___skinlets/">Skinlets</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group___themeing/">Themeing</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/modules/group__container/">Container</a>
    </li>
  
</ul>

            
          </li>
        
          
          
          
          
          
          
          
          <li class="docs-menu-item has-children">
            <a href="/docs/classes/">Classes</a>
            
            
              <button class="docs-submenu-toggle"><span class="screen-reader-text">Submenu</span><span class="icon-angle-right" aria-hidden="true"></span></button>
              
              


<ul class="docs-submenu">
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskAbstractButton/">QskAbstractButton</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskAnimationHint/">QskAnimationHint</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskAnimator/">QskAnimator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskAnimatorDriver/">QskAnimatorDriver</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskAnimatorEvent/">QskAnimatorEvent</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskAspect/">QskAspect</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoundedControl/">QskBoundedControl</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoundedInput/">QskBoundedInput</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoundedRangeInput/">QskBoundedRangeInput</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoundedValueInput/">QskBoundedValueInput</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBox/">QskBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxBorderColors/">QskBoxBorderColors</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxBorderMetrics/">QskBoxBorderMetrics</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxClipNode/">QskBoxClipNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxNode/">QskBoxNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxRenderer/">QskBoxRenderer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxRendererColorMap/">QskBoxRendererColorMap</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxShapeMetrics/">QskBoxShapeMetrics</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskBoxSkinlet/">QskBoxSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskColorFilter/">QskColorFilter</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskControl/">QskControl</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskCorner/">QskCorner</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskDialog/">QskDialog</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskDialogButton/">QskDialogButton</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskDialogButtonBox/">QskDialogButtonBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskDialogSubWindow/">QskDialogSubWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskDialogWindow/">QskDialogWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskDirtyItemFilter/">QskDirtyItemFilter</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskEvent/">QskEvent</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskFlickAnimator/">QskFlickAnimator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskFocusIndicator/">QskFocusIndicator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskFocusIndicatorSkinlet/">QskFocusIndicatorSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGeometryChangeEvent/">QskGeometryChangeEvent</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGesture/">QskGesture</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGestureEvent/">QskGestureEvent</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGestureRecognizer/">QskGestureRecognizer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGradient/">QskGradient</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGradientStop/">QskGradientStop</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphic/">QskGraphic</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicIO/">QskGraphicIO</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicImageProvider/">QskGraphicImageProvider</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicLabel/">QskGraphicLabel</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicLabelSkinlet/">QskGraphicLabelSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicNode/">QskGraphicNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicPaintEngine/">QskGraphicPaintEngine</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicProvider/">QskGraphicProvider</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicProviderMap/">QskGraphicProviderMap</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGraphicTextureFactory/">QskGraphicTextureFactory</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGridBox/">QskGridBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskGridLayoutEngine/">QskGridLayoutEngine</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskHintAnimator/">QskHintAnimator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskHintAnimatorTable/">QskHintAnimatorTable</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskIndexedLayoutBox/">QskIndexedLayoutBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskInputContext/">QskInputContext</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskInputContextFactory/">QskInputContextFactory</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskInputGrabber/">QskInputGrabber</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskInputPanel/">QskInputPanel</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskInputPanelBox/">QskInputPanelBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskInputPredictionBar/">QskInputPredictionBar</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskIntervalF/">QskIntervalF</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskLayoutChain/">QskLayoutChain</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskLayoutEngine2D/">QskLayoutEngine2D</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskLayoutHint/">QskLayoutHint</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskLinearBox/">QskLinearBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskLinearLayoutEngine/">QskLinearLayoutEngine</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskListView/">QskListView</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskListViewNode/">QskListViewNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskListViewSkinlet/">QskListViewSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskMargins/">QskMargins</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskMessageSubWindow/">QskMessageSubWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskMessageWindow/">QskMessageWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskMetaFunction/">QskMetaFunction</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskMetaInvokable/">QskMetaInvokable</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskObjectCounter/">QskObjectCounter</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskObjectCounterHook/">QskObjectCounterHook</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPageIndicator/">QskPageIndicator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPageIndicatorSkinlet/">QskPageIndicatorSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPaintedNode/">QskPaintedNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPainterCommand/">QskPainterCommand</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPanGesture/">QskPanGesture</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPanGestureRecognizer/">QskPanGestureRecognizer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPlainTextRenderer/">QskPlainTextRenderer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPopup/">QskPopup</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPopupEvent/">QskPopupEvent</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPopupSkinlet/">QskPopupSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskProgressBar/">QskProgressBar</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskProgressBarSkinlet/">QskProgressBarSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPushButton/">QskPushButton</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskPushButtonSkinlet/">QskPushButtonSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskQuick/">QskQuick</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskQuickItem/">QskQuickItem</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskRgbPalette/">QskRgbPalette</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskRgbValue/">QskRgbValue</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskRichTextRenderer/">QskRichTextRenderer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSGNode/">QskSGNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScaleEngine/">QskScaleEngine</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScaleRenderer/">QskScaleRenderer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScaleTickmarks/">QskScaleTickmarks</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScrollArea/">QskScrollArea</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScrollBox/">QskScrollBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScrollView/">QskScrollView</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskScrollViewSkinlet/">QskScrollViewSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSelectionSubWindow/">QskSelectionSubWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSelectionWindow/">QskSelectionWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSeparator/">QskSeparator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSeparatorSkinlet/">QskSeparatorSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSetup/">QskSetup</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskShadowMetrics/">QskShadowMetrics</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskShortcutHandler/">QskShortcutHandler</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskShortcutMap/">QskShortcutMap</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSimpleListBox/">QskSimpleListBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSizePolicy/">QskSizePolicy</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkin/">QskSkin</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinFactory/">QskSkinFactory</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinHintStatus/">QskSkinHintStatus</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinHintTable/">QskSkinHintTable</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinHintTableEditor/">QskSkinHintTableEditor</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinManager/">QskSkinManager</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinTransition/">QskSkinTransition</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinlet/">QskSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSkinnable/">QskSkinnable</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSlider/">QskSlider</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSliderSkinlet/">QskSliderSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStackBox/">QskStackBox</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStackBoxAnimator/">QskStackBoxAnimator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStackBoxAnimator1/">QskStackBoxAnimator1</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStackBoxAnimator3/">QskStackBoxAnimator3</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStandardSymbol/">QskStandardSymbol</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStatusIndicator/">QskStatusIndicator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskStatusIndicatorSkinlet/">QskStatusIndicatorSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSubWindow/">QskSubWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSubWindowArea/">QskSubWindowArea</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSubWindowAreaSkinlet/">QskSubWindowAreaSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSubWindowSkinlet/">QskSubWindowSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskSwipeGesture/">QskSwipeGesture</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTabBar/">QskTabBar</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTabButton/">QskTabButton</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTabButtonSkinlet/">QskTabButtonSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTabView/">QskTabView</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTabViewSkinlet/">QskTabViewSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTapAndHoldGesture/">QskTapAndHoldGesture</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTapGesture/">QskTapGesture</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextColors/">QskTextColors</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextInput/">QskTextInput</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextInputSkinlet/">QskTextInputSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextLabel/">QskTextLabel</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextLabelSkinlet/">QskTextLabelSkinlet</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextNode/">QskTextNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextOptions/">QskTextOptions</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextPredictor/">QskTextPredictor</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextRenderer/">QskTextRenderer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextureNode/">QskTextureNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextureNodePrivate/">QskTextureNodePrivate</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTextureRenderer/">QskTextureRenderer</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTickmarksNode/">QskTickmarksNode</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskTickmarksNodePrivate/">QskTickmarksNodePrivate</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskVariantAnimator/">QskVariantAnimator</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskVertex/">QskVertex</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskVirtualKeyboard/">QskVirtualKeyboard</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskWindow/">QskWindow</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskWindowChangeEvent/">QskWindowChangeEvent</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/classQskWindowPrivate/">QskWindowPrivate</a>
    </li>
  
    <li class="docs-menu-item">
      <a href="/docs/classes/structQskVirtualKeyboardLayouts/">QskVirtualKeyboardLayouts</a>
    </li>
  
</ul>

            
          </li>
        
      </ul><!-- .docs-menu -->
    </div><!-- .docs-nav-menu -->
  </div><!-- .docs-nav-inside -->
</nav><!-- .docs-nav -->

    <article class="post type-docs">
      <div class="post-inside">
        <header class="post-header">
          <h1 class="post-title line-left">controls/QskPopup.cpp</h1>
        </header><!-- .post-header -->
        <div class="post-content">
          <h2 id="functions">Functions</h2>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskPopup_8cpp/#function-qsksetfocus">qskSetFocus</a></strong>(QQuickItem * item, bool on)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskPopup_8cpp/#function-qsksendpopupevent">qskSendPopupEvent</a></strong>(QQuickWindow * window, QskPopup * popup, bool on)</td>
    </tr>
  </tbody>
</table>

<h2 id="functions-documentation">Functions Documentation</h2>

<h3 id="function-qsksetfocus">function qskSetFocus</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="n">qskSetFocus</span><span class="p">(</span>
    <span class="n">QQuickItem</span> <span class="o">*</span> <span class="n">item</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">on</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qsksendpopupevent">function qskSendPopupEvent</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskSendPopupEvent</span><span class="p">(</span>
    <span class="n">QQuickWindow</span> <span class="o">*</span> <span class="n">window</span><span class="p">,</span>
    <span class="n">QskPopup</span> <span class="o">*</span> <span class="n">popup</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">on</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="source-code">Source code</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/******************************************************************************
 * QSkinny - Copyright (C) 2016 Uwe Rathmann
 * This file may be used under the terms of the QSkinny License, Version 1.0
 *****************************************************************************/</span>

<span class="cp">#include "QskPopup.h"
#include "QskAspect.h"
#include "QskInputGrabber.h"
#include "QskQuick.h"
#include "QskWindow.h"
#include "QskEvent.h"
</span>

<span class="cp">#include &lt;private/qquickwindow_p.h&gt;
#include &lt;private/qquickitem_p.h&gt;
</span>

<span class="n">QSK_SUBCONTROL</span><span class="p">(</span> <span class="n">QskPopup</span><span class="p">,</span> <span class="n">Overlay</span> <span class="p">)</span>
<span class="n">QSK_SYSTEM_STATE</span><span class="p">(</span> <span class="n">QskPopup</span><span class="p">,</span> <span class="n">Closed</span><span class="p">,</span> <span class="n">QskAspect</span><span class="o">::</span><span class="n">FirstSystemState</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span> <span class="p">)</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">qskSetFocus</span><span class="p">(</span> <span class="n">QQuickItem</span><span class="o">*</span> <span class="n">item</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">item</span><span class="o">-&gt;</span><span class="n">window</span><span class="p">()</span> <span class="o">==</span> <span class="nb">nullptr</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="cm">/*
        For unknown reasons Qt::PopupFocusReason is blocked inside of
        QQuickItem::setFocus. So let's bypass it calling
        QQuickWindowPrivate::setFocusInScope/clearFocusInScope directly,
     */</span>

    <span class="k">if</span> <span class="p">(</span> <span class="k">const</span> <span class="k">auto</span> <span class="n">scope</span> <span class="o">=</span> <span class="n">qskNearestFocusScope</span><span class="p">(</span> <span class="n">item</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">auto</span> <span class="n">dw</span> <span class="o">=</span> <span class="n">QQuickWindowPrivate</span><span class="o">::</span><span class="n">get</span><span class="p">(</span> <span class="n">item</span><span class="o">-&gt;</span><span class="n">window</span><span class="p">()</span> <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">dw</span><span class="o">-&gt;</span><span class="n">setFocusInScope</span><span class="p">(</span> <span class="n">scope</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">PopupFocusReason</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="c1">// to avoid an assertion we have to check if we have the subFocus</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">QQuickItemPrivate</span><span class="o">::</span><span class="n">get</span><span class="p">(</span> <span class="n">scope</span> <span class="p">)</span><span class="o">-&gt;</span><span class="n">subFocusItem</span> <span class="o">==</span> <span class="n">item</span> <span class="p">)</span>
                <span class="n">dw</span><span class="o">-&gt;</span><span class="n">clearFocusInScope</span><span class="p">(</span> <span class="n">scope</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">PopupFocusReason</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskSendPopupEvent</span><span class="p">(</span>
    <span class="n">QQuickWindow</span><span class="o">*</span> <span class="n">window</span><span class="p">,</span> <span class="n">QskPopup</span><span class="o">*</span> <span class="n">popup</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">window</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="k">auto</span> <span class="n">type</span> <span class="o">=</span> <span class="n">on</span> <span class="o">?</span> <span class="n">QskEvent</span><span class="o">::</span><span class="n">PopupAdded</span> <span class="o">:</span> <span class="n">QskEvent</span><span class="o">::</span><span class="n">PopupRemoved</span><span class="p">;</span>

        <span class="n">QskPopupEvent</span> <span class="n">event</span><span class="p">(</span> <span class="n">type</span><span class="p">,</span> <span class="n">popup</span> <span class="p">);</span>
        <span class="n">QCoreApplication</span><span class="o">::</span><span class="n">sendEvent</span><span class="p">(</span> <span class="n">window</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">event</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">namespace</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">InputGrabber</span> <span class="k">final</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QskInputGrabber</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="n">Inherited</span> <span class="o">=</span> <span class="n">QskInputGrabber</span><span class="p">;</span>

      <span class="k">public</span><span class="o">:</span>
        <span class="n">InputGrabber</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">*</span> <span class="n">parent</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">Inherited</span><span class="p">(</span> <span class="n">parent</span> <span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

      <span class="k">protected</span><span class="o">:</span>
        <span class="kt">bool</span> <span class="n">event</span><span class="p">(</span> <span class="n">QEvent</span><span class="o">*</span> <span class="n">event</span> <span class="p">)</span> <span class="k">override</span>
        <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">Inherited</span><span class="o">::</span><span class="n">event</span><span class="p">(</span> <span class="n">event</span> <span class="p">);</span>

            <span class="k">const</span> <span class="kt">int</span> <span class="n">eventType</span> <span class="o">=</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">eventType</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">::</span><span class="n">MouseButtonPress</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">popup</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">QskPopup</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">parentItem</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">isAccepted</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
                        <span class="p">(</span> <span class="n">popup</span><span class="o">-&gt;</span><span class="n">popupFlags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">CloseOnPressOutside</span> <span class="p">)</span> <span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">popup</span><span class="o">-&gt;</span><span class="n">close</span><span class="p">();</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">eventType</span> <span class="o">==</span> <span class="n">QskEvent</span><span class="o">::</span><span class="n">GeometryChange</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">popup</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">QskPopup</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">parentItem</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="n">popup</span><span class="o">-&gt;</span><span class="n">hasOverlay</span><span class="p">()</span> <span class="p">)</span>
                        <span class="n">popup</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">();</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">ok</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">QskPopup</span><span class="o">::</span><span class="n">PrivateData</span>
<span class="p">{</span>
  <span class="k">public</span><span class="o">:</span>
    <span class="n">PrivateData</span><span class="p">()</span>
        <span class="o">:</span> <span class="n">flags</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="p">,</span> <span class="n">isModal</span><span class="p">(</span> <span class="nb">false</span> <span class="p">)</span>
        <span class="p">,</span> <span class="n">hasFaderEffect</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span>
        <span class="p">,</span> <span class="n">autoGrabFocus</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span>
        <span class="p">,</span> <span class="n">handoverFocus</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span>
    <span class="p">{</span>
    <span class="p">}</span>

    <span class="n">InputGrabber</span><span class="o">*</span> <span class="n">inputGrabber</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>

    <span class="n">uint</span> <span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">QskAspect</span> <span class="n">faderAspect</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">flags</span>           <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">isModal</span>        <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
    <span class="kt">bool</span> <span class="n">hasFaderEffect</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">const</span> <span class="kt">bool</span> <span class="n">autoGrabFocus</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">bool</span> <span class="n">handoverFocus</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">QskPopup</span><span class="o">::</span><span class="n">QskPopup</span><span class="p">(</span> <span class="n">QQuickItem</span><span class="o">*</span> <span class="n">parent</span> <span class="p">)</span>
    <span class="o">:</span> <span class="n">Inherited</span><span class="p">(</span> <span class="n">parent</span> <span class="p">)</span>
    <span class="p">,</span> <span class="n">m_data</span><span class="p">(</span> <span class="k">new</span> <span class="n">PrivateData</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// initially the popup is closed and invisible</span>
    <span class="n">Inherited</span><span class="o">::</span><span class="n">setVisible</span><span class="p">(</span> <span class="nb">false</span> <span class="p">);</span>
    <span class="n">setSkinStateFlag</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">Closed</span> <span class="p">);</span>

    <span class="c1">// we need to stop event propagation</span>
    <span class="n">setAcceptedMouseButtons</span><span class="p">(</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AllButtons</span> <span class="p">);</span>
    <span class="n">setWheelEnabled</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>

    <span class="c1">// we don't want to be resized by layout code</span>
    <span class="n">setTransparentForPositioner</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>

    <span class="n">setFlag</span><span class="p">(</span> <span class="n">ItemIsFocusScope</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
    <span class="n">setTabFence</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
    <span class="n">setFocusPolicy</span><span class="p">(</span> <span class="n">Qt</span><span class="o">::</span><span class="n">StrongFocus</span> <span class="p">);</span>

    <span class="cm">/*
        sending a notification to the window, that can
        be used to register popups for some sort of
        popup/window management
     */</span>
    <span class="n">qskSendPopupEvent</span><span class="p">(</span> <span class="n">window</span><span class="p">(),</span> <span class="k">this</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QskPopup</span><span class="o">::~</span><span class="n">QskPopup</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">qskSendPopupEvent</span><span class="p">(</span> <span class="n">window</span><span class="p">(),</span> <span class="k">this</span><span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">open</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">setOpen</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">close</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">setOpen</span><span class="p">(</span> <span class="nb">false</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setOpen</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="o">==</span> <span class="n">isOpen</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="p">)</span>
        <span class="n">QskControl</span><span class="o">::</span><span class="n">setVisible</span><span class="p">(</span> <span class="n">on</span> <span class="p">);</span>

    <span class="n">setSkinStateFlag</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">Closed</span><span class="p">,</span> <span class="o">!</span><span class="n">on</span> <span class="p">);</span>

    <span class="n">Q_EMIT</span> <span class="n">openChanged</span><span class="p">(</span> <span class="n">on</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="p">)</span>
        <span class="n">Q_EMIT</span> <span class="n">opened</span><span class="p">();</span>
    <span class="k">else</span>
        <span class="n">Q_EMIT</span> <span class="n">closed</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">isFading</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Q_EMIT</span> <span class="n">fadingChanged</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">on</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Inherited</span><span class="o">::</span><span class="n">setVisible</span><span class="p">(</span> <span class="nb">false</span> <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">testPopupFlag</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">DeleteOnClose</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">deleteLater</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">isOpen</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="o">!</span><span class="p">(</span> <span class="n">skinState</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">Closed</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">isFading</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span><span class="p">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">QskSkinHintStatus</span> <span class="n">status</span><span class="p">;</span>
    <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">effectiveSkinHint</span><span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">status</span> <span class="p">);</span>

    <span class="k">return</span> <span class="n">status</span><span class="p">.</span><span class="n">source</span> <span class="o">==</span> <span class="n">QskSkinHintStatus</span><span class="o">::</span><span class="n">Animator</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">QRectF</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">overlayRect</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">hasOverlay</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span><span class="o">-&gt;</span><span class="n">grabberRect</span><span class="p">();</span>

    <span class="k">return</span> <span class="n">QRectF</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">updateInputGrabber</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">parentItem</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">isVisible</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
        <span class="p">(</span> <span class="n">isModal</span><span class="p">()</span> <span class="o">||</span> <span class="n">testPopupFlag</span><span class="p">(</span> <span class="n">CloseOnPressOutside</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span> <span class="o">==</span> <span class="nb">nullptr</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span> <span class="n">children</span> <span class="o">=</span> <span class="n">childItems</span><span class="p">();</span>
            <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputGrabber</span><span class="p">(</span> <span class="k">this</span> <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">children</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="cm">/*
                    Even if the input grabber has no content it has an effect
                    on QQuickItem::childAt. Also tools like Squish struggle with
                    sorting out items without content.
                    So let's better move the grabber to the beginning.
                 */</span>
                <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span><span class="o">-&gt;</span><span class="n">stackBefore</span><span class="p">(</span> <span class="n">children</span><span class="p">.</span><span class="n">first</span><span class="p">()</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="cm">/*
                In QQuickWindowPrivate::deliverPressOrReleaseEvent ( 5.12 )
                might crash, when we delete the grabber as a result of a
                mouse event somewehere below the popup.
             */</span>
            <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span><span class="o">-&gt;</span><span class="n">setParentItem</span><span class="p">(</span> <span class="nb">nullptr</span> <span class="p">);</span>
            <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span><span class="o">-&gt;</span><span class="n">setParent</span><span class="p">(</span> <span class="nb">nullptr</span> <span class="p">);</span>
            <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span><span class="o">-&gt;</span><span class="n">deleteLater</span><span class="p">();</span>

            <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">QskAspect</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">faderAspect</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setFaderAspect</span><span class="p">(</span> <span class="n">QskAspect</span> <span class="n">aspect</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">faderAspect</span> <span class="o">=</span> <span class="n">aspect</span><span class="p">;</span>
    <span class="n">faderAspect</span><span class="p">.</span><span class="n">clearStates</span><span class="p">();</span> <span class="c1">// animated values are always stateless</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">faderAspect</span> <span class="o">==</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">isFading</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// stop the running animation TODO ...</span>
    <span class="p">}</span>

    <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span> <span class="o">=</span> <span class="n">faderAspect</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">isTransitionAccepted</span><span class="p">(</span> <span class="n">QskAspect</span> <span class="n">aspect</span> <span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">isVisible</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">hasFaderEffect</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">aspect</span><span class="p">.</span><span class="n">value</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">aspect</span> <span class="o">==</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span> <span class="p">)</span>
            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">aspect</span><span class="p">.</span><span class="n">isColor</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">aspect</span><span class="p">.</span><span class="n">subControl</span><span class="p">()</span> <span class="o">==</span> <span class="n">effectiveSubcontrol</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">Overlay</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">Inherited</span><span class="o">::</span><span class="n">isTransitionAccepted</span><span class="p">(</span> <span class="n">aspect</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setPriority</span><span class="p">(</span> <span class="n">uint</span> <span class="n">priority</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">priority</span> <span class="o">!=</span> <span class="n">priority</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">priority</span> <span class="o">=</span> <span class="n">priority</span><span class="p">;</span>
        <span class="n">Q_EMIT</span> <span class="n">priorityChanged</span><span class="p">(</span> <span class="n">priority</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">priority</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">priority</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setModal</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="o">==</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">isModal</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">isModal</span> <span class="o">=</span> <span class="n">on</span><span class="p">;</span>
    <span class="n">updateInputGrabber</span><span class="p">();</span>

    <span class="n">Q_EMIT</span> <span class="n">modalChanged</span><span class="p">(</span> <span class="n">on</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">isModal</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">isModal</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setFaderEffect</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="o">!=</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">hasFaderEffect</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">hasFaderEffect</span> <span class="o">=</span> <span class="n">on</span><span class="p">;</span>
        <span class="n">Q_EMIT</span> <span class="n">faderEffectChanged</span><span class="p">(</span> <span class="n">on</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">hasFaderEffect</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">hasFaderEffect</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setPopupFlags</span><span class="p">(</span> <span class="n">PopupFlags</span> <span class="n">flags</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">QskPopup</span><span class="o">::</span><span class="n">PopupFlags</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">popupFlags</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">PopupFlags</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setPopupFlag</span><span class="p">(</span> <span class="n">PopupFlag</span> <span class="n">flag</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">flags</span> <span class="o">=</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="p">)</span>
        <span class="n">flags</span> <span class="o">|=</span> <span class="n">flag</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">flags</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">flag</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">flags</span> <span class="o">!=</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
        <span class="n">updateInputGrabber</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">testPopupFlag</span><span class="p">(</span> <span class="n">PopupFlag</span> <span class="n">flag</span> <span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">flag</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">setOverlay</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">setFlagHint</span><span class="p">(</span> <span class="n">Overlay</span> <span class="o">|</span> <span class="n">QskAspect</span><span class="o">::</span><span class="n">Style</span><span class="p">,</span> <span class="n">on</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">Q_EMIT</span> <span class="n">overlayChanged</span><span class="p">(</span> <span class="n">on</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">resetOverlay</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">resetFlagHint</span><span class="p">(</span> <span class="n">Overlay</span> <span class="o">|</span> <span class="n">QskAspect</span><span class="o">::</span><span class="n">Style</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">Q_EMIT</span> <span class="n">overlayChanged</span><span class="p">(</span> <span class="n">hasOverlay</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">hasOverlay</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">flagHint</span><span class="o">&lt;</span> <span class="kt">bool</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">Overlay</span> <span class="o">|</span> <span class="n">QskAspect</span><span class="o">::</span><span class="n">Style</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">grabFocus</span><span class="p">(</span> <span class="kt">bool</span> <span class="n">on</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="o">==</span> <span class="n">hasFocus</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">on</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qskSetFocus</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">QQuickItem</span><span class="o">*</span> <span class="n">successor</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">handoverFocus</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="cm">/*
                Qt/Quick does not handover the focus to another item,
                when the active focus gets lost. For the situation of
                a popup being closed we try to do it.
             */</span>
            <span class="n">successor</span> <span class="o">=</span> <span class="n">focusSuccessor</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">successor</span> <span class="p">)</span>
            <span class="n">qskSetFocus</span><span class="p">(</span> <span class="n">successor</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">hasFocus</span><span class="p">()</span> <span class="p">)</span>
            <span class="n">qskSetFocus</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">event</span><span class="p">(</span> <span class="n">QEvent</span><span class="o">*</span> <span class="n">event</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">Inherited</span><span class="o">::</span><span class="n">event</span><span class="p">(</span> <span class="n">event</span> <span class="p">);</span>

    <span class="k">switch</span> <span class="p">(</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">KeyPress</span><span class="o">:</span>
        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">KeyRelease</span><span class="o">:</span>

        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">Wheel</span><span class="o">:</span>

        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">MouseButtonPress</span><span class="o">:</span>
        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">MouseMove</span><span class="o">:</span>
        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">MouseButtonRelease</span><span class="o">:</span>

        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">HoverEnter</span><span class="o">:</span>
        <span class="k">case</span> <span class="n">QEvent</span><span class="p">:</span><span class="o">:</span><span class="n">HoverLeave</span><span class="o">:</span>
        <span class="p">{</span>
            <span class="c1">// swallow the event</span>
            <span class="n">event</span><span class="o">-&gt;</span><span class="n">accept</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">w</span> <span class="o">=</span> <span class="n">qobject_cast</span><span class="o">&lt;</span> <span class="n">QskWindow</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">window</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">w</span><span class="o">-&gt;</span><span class="n">setEventAcceptance</span><span class="p">(</span> <span class="n">QskWindow</span><span class="o">::</span><span class="n">EventPropagationStopped</span> <span class="p">);</span>

            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="n">QskEvent</span><span class="p">:</span><span class="o">:</span><span class="n">Animator</span><span class="o">:</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span> <span class="n">animtorEvent</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">QskAnimatorEvent</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">event</span> <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">animtorEvent</span><span class="o">-&gt;</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskAnimatorEvent</span><span class="o">::</span><span class="n">Terminated</span> <span class="p">)</span>
                <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">animtorEvent</span><span class="o">-&gt;</span><span class="n">aspect</span><span class="p">()</span> <span class="o">==</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">faderAspect</span> <span class="p">)</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">isOpen</span><span class="p">()</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">Inherited</span><span class="o">::</span><span class="n">setVisible</span><span class="p">(</span> <span class="nb">false</span> <span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span> <span class="n">testPopupFlag</span><span class="p">(</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">DeleteOnClose</span> <span class="p">)</span> <span class="p">)</span>
                        <span class="n">deleteLater</span><span class="p">();</span>
                <span class="p">}</span>

                <span class="n">Q_EMIT</span> <span class="n">fadingChanged</span><span class="p">(</span> <span class="nb">false</span> <span class="p">);</span>
            <span class="p">}</span>

            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">default</span><span class="o">:</span>
        <span class="p">{</span>
            <span class="cm">/*
                Don't accept touch events otherwise we don't receive the
                synthesized mouse events and need to handle both type of
                events from now on.
                But by accepting the mouse event propagation of the touch
                events also stops.
             */</span>

            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ok</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">focusInEvent</span><span class="p">(</span> <span class="n">QFocusEvent</span><span class="o">*</span> <span class="n">event</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">Inherited</span><span class="o">::</span><span class="n">focusInEvent</span><span class="p">(</span> <span class="n">event</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">isFocusScope</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">isTabFence</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">scopedFocusItem</span><span class="p">()</span> <span class="o">==</span> <span class="nb">nullptr</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">reason</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">PopupFocusReason</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="cm">/*
                When receiving the focus we need to have a focused
                item, so that the tab focus chain has a starting point.

                But we only do it when the reason is Qt::PopupFocusReason
                as we also receive focus events during the process of reparenting
                children and setting the focus there can leave the item tree
                in an invalid state.
             */</span>

            <span class="k">if</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">focusItem</span> <span class="o">=</span> <span class="n">nextItemInFocusChain</span><span class="p">(</span> <span class="nb">true</span> <span class="p">)</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">qskIsItemComplete</span><span class="p">(</span> <span class="n">focusItem</span> <span class="p">)</span>
                    <span class="o">&amp;&amp;</span> <span class="n">qskIsAncestorOf</span><span class="p">(</span> <span class="k">this</span><span class="p">,</span> <span class="n">focusItem</span> <span class="p">)</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">focusItem</span><span class="o">-&gt;</span><span class="n">setFocus</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">focusOutEvent</span><span class="p">(</span> <span class="n">QFocusEvent</span><span class="o">*</span> <span class="n">event</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">Inherited</span><span class="o">::</span><span class="n">focusOutEvent</span><span class="p">(</span> <span class="n">event</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QQuickItem</span><span class="o">*</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">focusSuccessor</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="k">const</span> <span class="k">auto</span> <span class="n">scope</span> <span class="o">=</span> <span class="n">qskNearestFocusScope</span><span class="p">(</span> <span class="k">this</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="k">auto</span> <span class="n">children</span> <span class="o">=</span> <span class="n">qskPaintOrderChildItems</span><span class="p">(</span> <span class="n">scope</span> <span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">children</span><span class="p">.</span><span class="n">crbegin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">children</span><span class="p">.</span><span class="n">crend</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">auto</span> <span class="n">child</span> <span class="o">=</span> <span class="o">*</span><span class="n">it</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">child</span> <span class="o">!=</span> <span class="k">this</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">child</span><span class="o">-&gt;</span><span class="n">isFocusScope</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
                <span class="n">child</span><span class="o">-&gt;</span><span class="n">activeFocusOnTab</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">child</span><span class="o">-&gt;</span><span class="n">isVisible</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="n">child</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nb">nullptr</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">aboutToShow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">autoGrabFocus</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// What to do, when we are hidden below another popup ??</span>
        <span class="n">grabFocus</span><span class="p">(</span> <span class="nb">true</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Inherited</span><span class="o">::</span><span class="n">aboutToShow</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">itemChange</span><span class="p">(</span> <span class="n">QQuickItem</span><span class="o">::</span><span class="n">ItemChange</span> <span class="n">change</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QQuickItem</span><span class="o">::</span><span class="n">ItemChangeData</span><span class="o">&amp;</span> <span class="n">value</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">Inherited</span><span class="o">::</span><span class="n">itemChange</span><span class="p">(</span> <span class="n">change</span><span class="p">,</span> <span class="n">value</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">change</span> <span class="o">==</span> <span class="n">QQuickItem</span><span class="o">::</span><span class="n">ItemVisibleHasChanged</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">updateInputGrabber</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">value</span><span class="p">.</span><span class="n">boolValue</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">polish</span><span class="p">();</span> <span class="c1">// so that aboutToShow is called. TODO ...</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">grabFocus</span><span class="p">(</span> <span class="nb">false</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">change</span> <span class="o">==</span> <span class="n">QQuickItem</span><span class="o">::</span><span class="n">ItemParentHasChanged</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">delete</span> <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span><span class="p">;</span>
        <span class="n">m_data</span><span class="o">-&gt;</span><span class="n">inputGrabber</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>

        <span class="n">updateInputGrabber</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskPopup</span><span class="o">::</span><span class="n">windowChangeEvent</span><span class="p">(</span> <span class="n">QskWindowChangeEvent</span><span class="o">*</span> <span class="n">event</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">qskSendPopupEvent</span><span class="p">(</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">oldWindow</span><span class="p">(),</span> <span class="k">this</span><span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
    <span class="n">qskSendPopupEvent</span><span class="p">(</span> <span class="n">event</span><span class="o">-&gt;</span><span class="n">window</span><span class="p">(),</span> <span class="k">this</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>

    <span class="n">Inherited</span><span class="o">::</span><span class="n">windowChangeEvent</span><span class="p">(</span> <span class="n">event</span> <span class="p">);</span>
<span class="p">}</span>

<span class="cp">#include "moc_QskPopup.cpp"
</span></code></pre></div></div>

<hr />

<p>Updated on  3 February 2021 at 15:05:47 CET</p>

          
          
          
            
            
            
            
            
          
        </div><!-- .post-content -->
      </div><!-- .post-inside -->
    </article><!-- .post -->
    <nav id="page-nav" class="page-nav">
      <div id="page-nav-inside" class="page-nav-inside sticky">
        <h2 class="page-nav-title">Jump to Section</h2>
        <div id="page-nav-link-container"></div>
      </div><!-- .page-nav-inside -->
    </nav><!-- .page-nav -->
  </div><!-- .docs-content -->
</div><!-- .inner-->

  </main><!-- .site-content -->
  <footer id="colophon" class="site-footer outer">
  <div class="inner">
    <div class="site-footer-inside">
      <p class="site-info">
        
        
        <span class="copyright">&copy; Stackbit. All rights reserved. This Jamstack site was created on <a href="https://www.stackbit.com" target="_blank" rel="noopener">Stackbit</a>. Get yours <a href="https://app.stackbit.com/create?theme=libris" target="_blank" rel="noopener">here</a>.</span>
        
        
      </p><!-- .site-info -->
      
      
      <div class="social-links">
        
          
          
<a class="button button-icon" href="https://twitter.com/" target="_blank" rel="noopener">
  
  <span class="icon fab fa-twitter" aria-hidden="true"></span><span class="screen-reader-text">Twitter</span>
  
</a>

        
          
          
<a class="button button-icon" href="https://www.linkedin.com/" target="_blank" rel="noopener">
  
  <span class="icon fab fa-linkedin" aria-hidden="true"></span><span class="screen-reader-text">LinkedIn</span>
  
</a>

        
          
          
<a class="button button-icon" href="https://github.com/" target="_blank" rel="noopener">
  
  <span class="icon fab fa-github" aria-hidden="true"></span><span class="screen-reader-text">GitHub</span>
  
</a>

        
      </div><!-- .social-links -->
      
    </div><!-- .site-footer-inside -->
  </div><!-- .inner -->
</footer><!-- .site-footer -->

</div><!-- .site -->

        <!-- Scripts -->
        <script src="/assets/js/plugins.js"></script>
        <script src="/assets/js/main.js"></script>
        <script src="/assets/js/page-load.js"></script>
    </body> 
</html>
